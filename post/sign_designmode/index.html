<!doctype html><html lang=zh-cn><head><meta charset=utf-8><title>å•ä¾‹è®¾è®¡æ¨¡å¼ | ChuckLin's Blog</title><meta name=description content="Love and Peace"><meta name=author content><link rel=apple-touch-icon sizes=180x180 href=https://example.com/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://example.com/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://example.com/favicon-16x16.png><link rel=manifest href=https://example.com/site.webmanifest><link rel=mask-icon href=https://example.com/safari-pinned-tab.svg color=#00416a><meta name=msapplication-TileColor content="#00aba9"><meta name=theme-color content="#ffffff"><link rel=me href=mailto:mikumiku.lch@hotmail.com><link rel=me href=https://github.com/chuck1in><link rel=authorization_endpoint href=https://indieauth.com/auth><link rel=token_endpoint href=https://tokens.indieauth.com/token><link rel=stylesheet href=https://example.com/css/fonts.css><link rel=stylesheet href=https://example.com/css/style.css><meta name=viewport content="width=device-width,initial-scale=1"></head><body><div id=sitelogo><a class=glyph alt=Home href=https://example.com/><img src=https://example.com/images/site-logo.svg alt="Site Logo" height=64px width=64px></a></div><header><nav><div id=page-nav><div class=page-nav-item><a href=https://example.com/>Home</a></div><div class=page-nav-item><a href=/about/me><span>About</span></a></div><div class=page-nav-item><a href=/tags><span>Tag</span></a></div></div></nav></header><div id=content><article class=h-entry><header><h1 class="post-title p-name">å•ä¾‹è®¾è®¡æ¨¡å¼</h1><p class=post-date>Posted on
<time class=dt-published datetime=2018-10-01T18:23:00+08:00>1 October, 2018 at 18:23 +0800</time> by <a href=https://example.com/ class="p-author h-card" rel=author>Chuck Lin</a></p></header><section class="content e-content"><p>å•ä¾‹è®¾è®¡æ¨¡å¼æ˜¯åº”ç”¨æœ€å¹¿æ³›çš„è®¾è®¡æ¨¡å¼ï¼Œæ²¡æœ‰ä¹‹ä¸€ã€‚å½“æˆ‘ä»¬éœ€è¦æ§åˆ¶ä¸€ä¸ªç±»åªèƒ½è¢«åˆ›å»ºå‡ºå•ä¸ªå¯¹è±¡æ—¶ï¼Œå°±å¯ä»¥é‡‡ç”¨å•ä¾‹è®¾è®¡æ¨¡å¼ã€‚
ä½¿ç”¨ java æ¥å®ç°å•ä¾‹è®¾è®¡æ¨¡å¼ï¼Œæ™®éæœ‰å››ç§å®ç°æ–¹å¼ã€‚</p><ul><li>æ‡’æ±‰å¼</li><li>é¥¿æ±‰å¼</li><li>åŒæ£€é”</li><li>innerclass holder</li></ul><h2 id=æ€ä¹ˆç”¨>æ€ä¹ˆç”¨ï¼Ÿ</h2><h3 id=æ‡’æ±‰å¼>æ‡’æ±‰å¼</h3><p>æ‡’æ±‰å¼æ˜¯æœ€å¸¸è§çš„å•ä¾‹è®¾è®¡æ¨¡å¼çš„å®ç°æ–¹å¼ä¹‹ä¸€ã€‚æ‡’æ±‰ä»£è¡¨çš„å«ä¹‰ä¸º lazy-loadï¼Œæ„å‘³ç€å½“å•ä¾‹å¯¹è±¡åœ¨é¡¹ç›®ä¸­çœŸæ­£è¢«æŸä¸ªä¸šåŠ¡æ¨¡å—ä½¿ç”¨æ—¶ï¼Œå¯¹è±¡æ‰ä¼šè¢«åˆ›å»ºã€‚</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#f92672>package</span> com.designpattern.singleton<span style=color:#f92672>;</span>

<span style=color:#75715e>/**
</span><span style=color:#75715e> * å•ä¾‹è®¾è®¡æ¨¡å¼-æ‡’æ±‰å¼
</span><span style=color:#75715e> */</span>
<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SingletonLazyMode</span> <span style=color:#f92672>{</span>


    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> SingletonLazyMode shm<span style=color:#f92672>;</span>

    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * ç§æœ‰åŒ–æ„é€ å™¨
</span><span style=color:#75715e>     */</span>
    <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>SingletonLazyMode</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>

    <span style=color:#f92672>}</span>

    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * è·å–å•ä¾‹
</span><span style=color:#75715e>     * é¢ä¸´å¹¶å‘å®‰å…¨é—®é¢˜,å¯èƒ½ä¼šåˆ›å»ºå¤šä¸ªå®ä¾‹
</span><span style=color:#75715e>     * éœ€è¦å¯¹æ–¹æ³•è¿›è¡ŒåŒæ­¥.(ç‹¬å é”)
</span><span style=color:#75715e>     *
</span><span style=color:#75715e>     * @return obj
</span><span style=color:#75715e>     */</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>synchronized</span> SingletonLazyMode <span style=color:#a6e22e>getSingleton</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
        <span style=color:#75715e>// åœ¨åˆ¤æ–­å¤„å¯èƒ½å‘ç”Ÿå¹¶å‘å®‰å…¨é—®é¢˜.
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>shm <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
            <span style=color:#66d9ef>return</span> shm<span style=color:#f92672>;</span>
        <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#f92672>{</span>
            shm <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SingletonLazyMode<span style=color:#f92672>();</span>
            <span style=color:#66d9ef>return</span> shm<span style=color:#f92672>;</span>
        <span style=color:#f92672>}</span>
    <span style=color:#f92672>}</span>

<span style=color:#f92672>}</span>
</code></pre></div><h3 id=é¥¿æ±‰å¼>é¥¿æ±‰å¼</h3><p>é¥¿æ±‰å¼ä¸æ‡’æ±‰å¼åˆšå¥½æ˜¯ä¸€å¯¹åä¾‹ã€‚ä¸€æ—¦é¥¿æ±‰å¼çš„ class è¢«åŠ è½½ä¸”è¿›è¡Œåˆå§‹åŒ–åï¼Œå•ä¾‹å¯¹è±¡å°±ä¼šè¢«é©¬ä¸Šåˆ›å»ºã€‚</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#f92672>package</span> com.designpattern.singleton<span style=color:#f92672>;</span>

<span style=color:#75715e>/**
</span><span style=color:#75715e> * å•ä¾‹è®¾è®¡æ¨¡å¼-é¥¿æ±‰å¼
</span><span style=color:#75715e> */</span>
<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SingletonHungryMode</span> <span style=color:#f92672>{</span>


    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> SingletonHungryMode shm <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SingletonHungryMode<span style=color:#f92672>();</span>


    <span style=color:#75715e>// æ„é€ å™¨
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>SingletonHungryMode</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>


    <span style=color:#f92672>}</span>

    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * è¿”å›å®ä¾‹å¯¹è±¡
</span><span style=color:#75715e>     * é¥¿æ±‰å¼é¿å…äº†å¹¶å‘å®‰å…¨é—®é¢˜,ä½†æ˜¯å´æ— æ³•å®ç°lazyLoad
</span><span style=color:#75715e>     *
</span><span style=color:#75715e>     * @return
</span><span style=color:#75715e>     */</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> SingletonHungryMode <span style=color:#a6e22e>getSingleton</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>return</span> shm<span style=color:#f92672>;</span>
    <span style=color:#f92672>}</span>

<span style=color:#f92672>}</span>

</code></pre></div><p>é¥¿æ±‰å¼å¯¹è±¡æ— æ³•å®ç° lazy-loadã€‚å½“ç±»è¢«åå°„è°ƒç”¨æˆ–è®¾ç½®è¯»å–ç±»çš„é™æ€å­—æ®µä»¥åŠæ‰§è¡ŒæŸä¸ªé™æ€æ–¹æ³•æ—¶ï¼Œç±»çš„é™æ€æˆå‘˜å˜é‡å°±ä¼šè¢«åˆå§‹åŒ–ã€‚</p><h3 id=innerclass-holder>innerclass holder</h3><p>é…åˆé™æ€å†…éƒ¨ç±»å®ç°çš„å•ä¾‹æ¨¡å¼ã€‚å³ä½¿å¤–éƒ¨ç±»çš„ä»»ä½•æˆå‘˜è¢«è®¿é—®ï¼ŒæŒæœ‰å¤–éƒ¨ç±»å•ä¾‹å¯¹è±¡çš„å†…éƒ¨ç±»ï¼Œç›´åˆ° getInstance æ–¹æ³•è¢«è°ƒç”¨ä¸ºæ­¢ï¼Œéƒ½ä¸ä¼šè¢«åˆå§‹åŒ–ã€‚
è¿™ç§æ¨¡å¼å³å®ç°äº† lazy-loadï¼Œåˆé¿å…äº†æ™®é€šæ‡’æ±‰å¼çš„å¹¶å‘å®‰å…¨é—®é¢˜ã€‚</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#f92672>package</span> com.designpattern.singleton<span style=color:#f92672>;</span>

<span style=color:#75715e>/**
</span><span style=color:#75715e> * å•ä¾‹è®¾è®¡æ¨¡å¼-innerclass holder
</span><span style=color:#75715e> */</span>
<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SingletonInnerMode</span> <span style=color:#f92672>{</span>


    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * ç§æœ‰åŒ–æ„é€ å™¨
</span><span style=color:#75715e>     */</span>
    <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>SingletonInnerMode</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>

    <span style=color:#f92672>}</span>


    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * æŒæœ‰å¤–éƒ¨ç±»å¯¹è±¡çš„å¼•ç”¨.
</span><span style=color:#75715e>     * æ¯æ¬¡è¢«åˆå§‹åŒ–å,simåªä¼šè¢«åŠ è½½ä¸€æ¬¡.
</span><span style=color:#75715e>     */</span>
    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SingletonInnerHolder</span> <span style=color:#f92672>{</span>

        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> SingletonInnerMode sim <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SingletonInnerMode<span style=color:#f92672>();</span>

        <span style=color:#75715e>/**
</span><span style=color:#75715e>         * ç§æœ‰åŒ–æ„é€ å™¨
</span><span style=color:#75715e>         */</span>
        <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>SingletonInnerHolder</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>

        <span style=color:#f92672>}</span>

    <span style=color:#f92672>}</span>

    <span style=color:#75715e>/**
</span><span style=color:#75715e>     * è·å–å•ä¾‹å¯¹è±¡.
</span><span style=color:#75715e>     * getInstanceè¢«è°ƒç”¨æ—¶å€™,å†…éƒ¨ç±»æ‰ä¼šè¢«åŠ è½½
</span><span style=color:#75715e>     *
</span><span style=color:#75715e>     * @return
</span><span style=color:#75715e>     */</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> SingletonInnerMode <span style=color:#a6e22e>getInstanse</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
        <span style=color:#75715e>// è®¿é—®æˆå‘˜å˜é‡æ—¶,å†…éƒ¨ç±»çš„é™æ€æˆå‘˜å˜é‡æ‰è¢«åˆå§‹åŒ–
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>return</span> SingletonInnerHolder<span style=color:#f92672>.</span><span style=color:#a6e22e>sim</span><span style=color:#f92672>;</span>
    <span style=color:#f92672>}</span>

<span style=color:#f92672>}</span>


</code></pre></div><h2 id=æ€»ç»“>æ€»ç»“</h2><p>åœ¨å¤§å¤šæ•°é¡¹ç›®ä¸­ï¼Œå¦‚æœä½ å¯¹æ€§èƒ½ä¸æ˜¯è¦æ±‚ç‰¹åˆ«è‹›åˆ»ï¼Œé¥¿æ±‰å¼å¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚å¦‚æœä½ å–œæ¬¢ lazy-loadï¼Œé‚£ä¹ˆæ™®é€šçš„æ‡’æ±‰å¼åœ¨å¤§éƒ¨åˆ†é¡¹ç›®ä¸­ä¹Ÿå®Œå…¨å¤Ÿç”¨ã€‚innerclass holder å®ç°å¾ˆå·§å¦™ï¼Œå¦‚æœä½ çš„æŸä¸ªç±»åœ¨åˆå§‹åŒ–æ—¶ä¼šè¿›è¡Œå¤§é‡è¿ç®—ï¼Œåˆ™æ¨èä½¿ç”¨å®ƒæ¥è§£å†³é—®é¢˜ã€‚</p></section><footer><a class="permalink u-url" href=https://example.com/post/sign_designmode/>ğŸ”—</a><hr class=post-underline><p class=post-tag>Tags for this post:
<a href=https://example.com/tags/java class="post-tag p-category">java</a></p></footer></article></div><div class=h-card><img class=u-photo src=https://example.com/images/site-logo.svg><div class=card-content><h2 class=card-name><a class="p-name u-url" href=https://example.com/ rel=me>Chuck Lin</a></h2><p class=card-subhead><span class=p-locality>Chengdu</span>,
<span class=p-country-name>China</span><br><a class=u-email href=mailto:mikumiku.lch@hotmail.com>Email me</a></p></div><p class=p-note>Love and Peace</p></div><div id=footer><nav id=article-skip><div class=next><a alt="Newer article" href=https://example.com/post/git/>&larr; Newer</a></div><div class=top><a alt="Top of page" href=#>Top</a></div><div class=prev><a alt="Older article" href=https://example.com/post/command_designmode/>Older &rarr;</a></div></nav><aside id=social><div id=social-icons><div class=icon-24x24><a class=glyph alt="GitHub profile" href=https://github.com/chuck1in><img src=https://example.com/icons/github.svg height=24px width=24px></a></div></div></aside><p class=copyright>Copyright Â© 2021 Chuck Lin. All rights reserved.</p></div></body></html>